<template>
  <h1 class="name">Modal Challenge</h1>
  <require from="./challenge.scss"></require>
  <button type="button" click.delegate="toggleModalVisible()()">
    Open Modal
  </button>
  <button type="button" click.delegate="testButton()">test me!</button>

  <div class="modal-body" show.bind="showModal">
    <div class="modal-content">
      <header>
        <button
          type="button"
          class="modalback"
          show.bind="showProductList"
          click.delegate="backButton()"
        >
          <img src="img/arrow-left.png" alt="backarrow" />
        </button>
        <h3 class="modalname">${title}</h3>

        <button
          type="button"
          class="modalclose"
          click.delegate="toggleModalVisible()"
        >
          <img src="img/x.png" alt="x" />
        </button>
      </header>
      <div class="modalsearchbox">
        <img src="img/search.png" alt="search" />
        <input
          type="text"
          id="modal-input"
          placeholder="${supplierPage === false ? 'Search Products' : 'Search suppliers'}"
        />
      </div>
      <div
        class="supplier-list"
        if.bind="!showProductList"
        show.bind="isContentShowing"
      >
        <ul>
          <li class="items" repeat.for="supplier of suppliers">
            <a
              href="#"
              click.delegate="selectSupplier(supplier)"
              show.bind="supplierPage"
            >
              ${supplier.name}
            </a>
          </li>
        </ul>
      </div>

      <div class="product-list" if.bind="showProductList">
        <ul>
          <li
            class="isProductDropDownActive === true ? '' : 'nohoverproductlist'"
            repeat.for="product of products"
          >
            <a
              href="#"
              id="onlypaddingright"
              class="products"
              click.delegate="selectParentProduct(product.id)"
            >
              <img src="./img/chevron-right.png" class="arrow" />${product.name}
            </a>
            <ul
              if.bind="selectedParentProduct === product.id && isProductDropDownActive"
              class="childproduct-ul"
            >
              <li
                class="childproduct-li"
                repeat.for="childProduct of product.childProducts"
              >
                <input
                  type="checkbox"
                  class="selectedProduct"
                  click.delegate="checkboxfunc(childProduct, childProduct.id)"
                  model.bind="childProduct.id"
                  checked.bind="childProductIds"
                />
                <a href="#" class="childproduct-a">${childProduct.name} </a>
                <input
                  type="number"
                  class="productCount"
                  min="0"
                  if.bind="childProduct.isSelected"
                  placeholder="..."
                />
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <ul class="selectPage" if.bind="showArray">
        <li repeat.for="child of selectedChildren">${child}</li>
      </ul>
    </div>

    <div class="button-wrapper">
      <button
        type="submit"
        class="${selectedChildren.length > 0 ? 'active': ''}"
        click.trigger="showChildArr()"
        disabled.bind="selectedChildren.length === 0"
      >
        ${selectedChildren.length}
        <span>${selectedChildren.length != 1 ? 'products' : 'product' }</span>
        selected
      </button>
      <div class="bottom-buttons">
        <button
          class="${isArrayDisplayed === true && selectedChildren.length > 0 ? 'cancelColor': ''}"
          click.trigger="cancelSelection()"
          disabled.bind="isArrayDisplayed === false"
        >
          CANCEL
        </button>
        <button class="${selectedChildren.length > 0 ? 'addColor': ''}">
          ADD
        </button>
      </div>
    </div>
  </div>
</template>
